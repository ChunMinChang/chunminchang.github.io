<html>
<head>
<title>Window Counter/Checker</title>
<script type='text/javascript' src='window_counter.js'></script>
<script type='text/javascript'>

var wCounter = undefined;
var wChecker = undefined;

function Count(size, target, value)
{
  console.assert(Number(size), 'the size should be a number');
  console.assert(Number(target), 'the target should be a number');
  console.assert(Number(value), 'the value should be a number');

  // Create WindowCounter and WindowChecker if they don't exist.
  if (!wCounter) {
    console.log('Create a WindowCounter');
    wCounter = new WindowCounter(size);
  }

  if (!wChecker) {
    console.log('Create a WindowChecker');
    wChecker = new WindowChecker(size, target);
  }

  // Put the value to WindowCounter and WindowChecker.
  wCounter.count(value);
  wChecker.count(value);

  // Show the results
  ShowResults();
}

function ShowResults()
{
  if (wCounter) {
    let sum = document.getElementById('sum');
    sum.innerText = wCounter.sum;
    let areAllSame = document.getElementById('areAllSame');
    areAllSame.innerText = wCounter.areAllSame;
    AreAllSameAs();
  }

  if (wChecker) {
    let areAllSameAsTarget = document.getElementById('areAllSameAsTarget');
    areAllSameAsTarget.innerText = wChecker.areAllSameAsTarget;
  }
}

function AreAllSameAs(event)
{
  if (!wCounter) {
    return;
  }

  let dynamicTarget = Number(document.getElementById('dynamicTarget').value);
  if (!dynamicTarget) {
    return;
  }

  let areAllSameAs = document.getElementById('areAllSameAs');
  areAllSameAs.innerText = wCounter.areAllSameAs(dynamicTarget);
}

function GetInput(event) {
  let value = Number(document.getElementById('input').value);
  if (!value) {
    console.log('The input should be a number!');
    return;
  }

  // If window size isn't set, then set it first.
  let ws = document.getElementById('windowSize');
  if (!Number(ws.innerText) > 0) {
    ws.innerText = value;
    return;
  }

  // If target isn't set, then set it before entering data.
  let target = document.getElementById('target');
  if (!Number(target.innerText)) {
    target.innerText = value;
    return;
  }

  // Count the data.
  Count(Number(ws.innerText), Number(target.innerText), value);

  // Show the value on data field.
  let data = document.getElementById('data');
  data.innerText += value + ', ';
}

document.addEventListener('DOMContentLoaded', function(event) {
  // Pass the value if user press the `Enter`.
  document.addEventListener('keyup', function(e) {
    if (e.keyCode == 13) {
      GetInput(e);
    }
  }, false);

  // Pass the value if user click the button.
  document.getElementById('enter').addEventListener('click', GetInput, false);

  // Enabling to check the dynamic target without new input.
  document.getElementById('check').addEventListener('click', AreAllSameAs, false);
}, false);
</script>
</head>
<body>
  <div id='test'>
    <h2>Test</h2>
    Window Size(must > 0): <p id='windowSize' style='display: inline;'></p><br>
    Target: <p id='target' style='display: inline;'></p><br>
    Data: <p id='data' style='display: inline;'></p><br>
    <input id='input' type='text' value='0' size='4'>
    <button id='enter'>enter</button>
  </div>
  <div id='result'>
    <h2>Result</h2>
    Sum of window:  <p id='sum' style='display: inline;'></p><br>
    are all data in window same? <p id='areAllSame' style='display: inline;'></p><br>
    are all data in window same as target? <p id='areAllSameAsTarget' style='display: inline;'></p><br>
    are all data in window same as <input id='dynamicTarget' type='text' value='0' size='4'>?
    <p id='areAllSameAs' style='display: inline;'></p>
    <button id='check'>check</button>
  </div>
</body>
</html>